%=========================== Uvod =================================
\chapter{Popis protokolu}

Bull's Authentication Protokol\cite{bull} bol predstavený v roku 1997. Jeho autorom je J.Bull po ktorom nesie meno aj autentifikaèný protokol. Úlohou tohto protokolu je distribúcia 
nových kµúèov cez fixný poèet klientov a server, prièom ka¾dá susedná dvojica vlastní jeden takýto kµúè. 

Popis protokolu je nasledovný. V prvom kroku ¾iadajú úèastníci server o kµúèe pre dvojice susedných klientov. Táto ¾iados» prebieha tak, ¾e klienti vytvoria akúsi "re»az", kedy prvý klient 
po¾iada o kµúè susedného klienta, ten daµ¹ieho susedného klienta a¾ posledný klient po¹le zabalené správy so ¾iadostami o kµúèe serveru. Takto je vytvorená "re»az" kedy sú správy o ¾iados» 
kµúèa zabalené rekurzívne. V momente ked server príjme túto zabalenú správu, server vygeneruje relaèné kµúèe pre dvojice klientov. Tieto dvojice kµúèov sú odoslané spä» najbli¾siemu klientovi
(tomu, ktorý odosielal správu serveru). Následne tento klient po¹le spoloèný kµuè pre dvojicu spolu so v¹etkými zvy¹nými kµúèami spä» svojmu predchodzovi, tento úkon sa opakuje kým nieje 
kµúè odoslaný prvému klientovi. Grafická reprezentácia je obsiahnutá v obrázku(1.1)

\begin{figure}[ht]
 \begin{center}
   \includegraphics[scale=0.55]{fig/bull.png}
    \caption{Grafická reprezentácia protokolu}
 \end{center}
\end{figure}

\newpage

\noindent \texttt{A, B, C, S} :   	klienti a server \\
\texttt{Kab, Kbc} :   	symetrické kµuèe pre dvojicu susedných klientov \\
\texttt{Na, Nb, Nc} :   	èíslo - nonce \\
\texttt{Kas, Kbs, Kcs} :   	 symetrické kµúèe\\
\texttt{h }:   		hashovacia funkcia \\
\\
\noindent\texttt{A computes Xa = h((A,B,Na),Kas), (A,B,Na)} \\
\texttt{1.   	A 	-> 	B 	:   	Xa} \\
\texttt{B computes Xb = h((B,C,Nb,Xa),Kbs), (B,C,Nb,Xa)} \\
\texttt{2.   	B 	-> 	C 	:   	Xb} \\
\texttt{C computes Xc = h((C,S,Nc,Xb),Kcs), (C,S,Nc,Xb)} \\
\texttt{3.   	C 	-> 	S 	:   	Xc} \\
\texttt{4.   	S 	-> 	C 	:   	A, B, Kab xor h(Na,Kas), {A,B,Na}Kab,}\\
\texttt{  	  	  	  	  	B, A, Kab xor h(Nb,Kbs), {B,A,Nb}Kab,}\\
\texttt{  	  	  	  	  	B, C, Kbc xor h(Nb,Kbs), {B,C,Nb}Kbc,}\\
\texttt{  	  	  	  	  	C, B, Kbc xor h(Nc,Kcs), {C,B,Nc}Kbc}\\
\texttt{5.   	C 	-> 	B 	:   	A, B, Kab xor h(Na,Kas), {A,B,Na}Kab,}\\
\texttt{  	  	  	  	  	B, A, Kab xor h(Nb,Kbs), {B,A,Nb}Kab,}\\
\texttt{  	  	  	  	  	B, C, Kbc xor h(Nb,Kbs), {B,C,Nb}Kbc}\\
\texttt{6.   	B 	-> 	A 	:   	A, B, Kab xor h(Na,Kas), {A,B,Na}Kab}\\

\subsubsection{Známe útoky}
V roku 1998 bol publikovaný útok na tento autentifikaèný protokol. Útok sa nazýva "domino attack". Tento útok predstavili P. Y. A Ryan a S. A. Schneider\cite{utok}. K tomuto útoku je potrebné aby útoèník bol v pomyselnej "re»azi" pri ¾iadaní a následne
prijímaní susedných kµúèov. Ak je útoèník(Carl) posledným klientom, server mu (4. krok) po¹le v¹etky kµúèe pre dvojice klientov, teda zachytí aj nasledujúce správy: \texttt{Kab xor h(Nb,Kbs)} a \texttt{Kbc xor h(Nb,Kbs)}.
Carl pozná kµúè \texttt{Kbc}, a ked¾e \texttt{Kab =  Kbc xor Kab xor h(Nb, Kbs) xor Kbc xor h(Nb,Kbs)}, takto Carl vlastní kµúè \texttt{Kab}, ktorý bol pôvodne urèený len pre Alice a Boba. 


\chapter{Analitycká analýza chovania protokolu}

\begin{table}[h]
\scalebox{0.6}{
\begin{tabular}{|c|l|l|}
\hline
\multicolumn{1}{|l|}{Krok}                                                                    & Znalosti                                                                                                                                                                                                       & Predpoklady                                                                                                                                                                                                  \\ \hline
\multicolumn{1}{|l|}{\begin{tabular}[c]{@{}l@{}}Poèiatoèné \\ podminky\end{tabular}}          & \begin{tabular}[c]{@{}l@{}}A: A, B, S, Kas,Na\\ B: B,C,S, Kbs, Nb\\ C: C, S, Kcs, Nc\\ S: S, Kas, Kbs, Kcs\end{tabular}                                                                                        & \begin{tabular}[c]{@{}l@{}}A: S: Kas\\ B: S: Kbs\\ C: S: Kcs\\ S: A: Kas, S:B:Kbs, S:C: Kcs\end{tabular}                                                                                                     \\ \hline
\multicolumn{1}{|l|}{\begin{tabular}[c]{@{}l@{}}Cieµové\\ podmienky\end{tabular}}             & \begin{tabular}[c]{@{}l@{}}A: Kab\\ B: Kab, Kbc\\ C: Kbc\end{tabular}                                                                                                                                          & \begin{tabular}[c]{@{}l@{}}A: B: Kab\\ B: A: Kab, B: C: Kbc\\ C: B: Kbc\end{tabular}                                                                                                                         \\ \hline
\multicolumn{1}{|l|}{\begin{tabular}[c]{@{}l@{}}Zakázané\\ cieµové \\ podmienky\end{tabular}} & \begin{tabular}[c]{@{}l@{}}A: Kbs, Kcs, Kbc\\ B: Kas, Kcs\\ C: Kas, Kbs, Kab\end{tabular}                                                                                                                      &                                                                                                                                                                                                              \\ \hline
1                                                                                             & \begin{tabular}[c]{@{}l@{}}A: A, B, S, Kas, Na\\ B: B, C, S, Kbs, Na, Nb\\ C: C, S, Kcs, Nc\\ S: S, Kas, Kbs, Kcs\end{tabular}                                                                                 & \begin{tabular}[c]{@{}l@{}}A: B: A, Na, A: S: Kas\\ B: S: Kbs\\ C: S: Kcs\\ S: A: Kas, S: B: Kbs, S: C: Kcs\end{tabular}                                                                                     \\ \hline
2                                                                                             & \begin{tabular}[c]{@{}l@{}}A: A, B, S, Kas,Na\\ B: B, C, S, Kbs,Na, Nb\\ C: C, S, Kcs, A, Na, Nb, Nc\\ S: S, Kas, Kbs, Kcs\end{tabular}                                                                        & \begin{tabular}[c]{@{}l@{}}A: S: Kas, A: B: Na\\ B: S: Kbs, B: C: Na, Nb, A, B\\ C: S: Kcs, S: B: Kbs,\\ S: C: Kcs, S: A: Kas\end{tabular}                                                                   \\ \hline
3                                                                                             & \begin{tabular}[c]{@{}l@{}}A: A, B, S, Na, Kas\\ B: B, C, S, Kbs,Na, Nb\\ C: A, C, S, Kcs, Na, Nb, Nc\\ S: S, A, B, C, Kas, Kbs, Kcs, Na, Nb, Nc\end{tabular}                                                  & \begin{tabular}[c]{@{}l@{}}A: S: Kas, A: B: Na,\\ B: S: Kbs, B: C: Na, Nb, A, B\\ C: S: Kcs, A, B, C, Na, Nb, Nc\\ S: B: Kbs; S: C: Kcs; S: A: Kas\end{tabular}                                              \\ \hline
4                                                                                             & \begin{tabular}[c]{@{}l@{}}A: A, B, S, Kas,Na, \\ B: B, C, S, Kbs,Na, Nb\\ C: C, S, A, Kbc, Kcs, Na, Nb, m1, m2, m3, m4\\ S: S, A, B, C, Kas, Kbs, Kcs, Na, Nb, Nc\end{tabular}                                & \begin{tabular}[c]{@{}l@{}}A: S: Kas, A: B: Na,\\ B: S: Kbs, B: C: Na, Nb, A, B\\ C: S: Kcs, A, B, C, Na, Nb, Nc \\ S: B: Kbs, S: C: Kcs, m1, m2, m3, m4, S: A: Kas\end{tabular}                             \\ \hline
5                                                                                             & \begin{tabular}[c]{@{}l@{}}A: A, B, S, Kas, Na\\ B: B, C, S, Kab, Kbs, Kbc, Na, Nb, m1, m2, m3\\ C: C, A, S, Nc, Kcs, Kbc, Na, Nb, m1, m2, m3, m4\\ S: S, A, B, C, Kas, Kbs, Kcs, Na, Nb, Nc\end{tabular}      & \begin{tabular}[c]{@{}l@{}}A: S: Kas, A: B: Na,\\ B: S: Kbs, B: C: Na, Nb, A, B \\ C: S: Kcs, A, B, C, Na, Nb, Nc, C: B: m1, m2, m3,\\ S: B: Kbs, S: C: Kcs, m1, m2, m3, m4, S: A: Kas\end{tabular}          \\ \hline
6                                                                                             & \begin{tabular}[c]{@{}l@{}}A: A, B, S, Kas, Kab,Na, m1 \\ B: B, C, S, Kab, Kbs, Kbc,Na, Nb, m1, m2, m3\\ C: C, A, S, Kbc, Kcs, Na, Nb, m1, m2, m3, m4\\ S: S, A, B, C,  Kas, Kbs, Kcs, Na, Nb, Nc\end{tabular} & \begin{tabular}[c]{@{}l@{}}A: S: Kas, A: B: Na\\ B: S: Kbs, B: C: Na, Nb, A, B, B: A: m1 \\ C: S: Kcs, A, B, C, Na, Nb, Nc, C: B: m1, m2, m3,\\ S: B: Kbs, S: C: Kcs, m1, m2, m3, m4, S: A: Kas\end{tabular} \\ \hline
\end{tabular}}
\end{table}

\chapter{Analýza komunikácie BP z rôznych pohµadov subjektov}
Nasleduje analýza komunikácie jak je uvedené v èlánku od Alvesa-fossa\cite{alves-foss}

\noindent \textbf{BP z pohµadu subjektu A:}


\begin{table}[h]
\begin{tabular}{|l|l|}
\hline
\textbf{Správa}                                     & \textbf{Popis}                       \\ \hline
\texttt{A1: A: computes Xa = h((A, B, Na), Kas), (A, B, Na)} & A vytvorí správu                     \\ \hline
\texttt{A2: A->: Xa}                                          & A po¹ele správu                      \\ \hline
\texttt{A3: ->A: A, B, Kab xor h(Na, Kas), \{A, B, Na\}Kab}   & A príjme správu		            \\ \hline
\texttt{A4: A: compute h(Na, Kas)}                           & A vypoèíta správu                    \\ \hline
\texttt{A5: A: h(Na, Kas) xor (Kab xor h(Na, Kas))}          & A získa kµúè                         \\ \hline
\texttt{A6: A: decrypt \{A, B, Na\}Kab}                      & A de¹ifruje správu                   \\ \hline
\end{tabular}
\end{table}


\noindent \textbf{BP z pohµadu subjektu B:}
\noindent
\begin{table}[h]
\scalebox{0.9}{
\begin{tabular}{|l|l|}
\hline
\textbf{Správa}                                                                                                                                                                                                    & \textbf{Popis}                       \\ \hline
\texttt{B1: B: computes Xb = h((B, C, Nb, Xa), Kbs), (B, C, Nb, Xa)}                                                                                                                                                        & B vytvorí správu                     \\ \hline
\texttt{B2: B->: Xb}                                                                                                                                                                                                         & B po¹ele správu                      \\ \hline
\texttt{\begin{tabular}[c]{@{}l@{}}B3: ->B: A, B, Kab xor h(Na, Kas), \{A, B, Na\}Kab,     \\ \hspace{10 mm} B, A, Kab xor h(Nb, Kbs), \{B, A, Nb\}Kab,\\ \hspace{10 mm} B, C, Kbc xor h(Nb, Kbs), \{B, C, Nb\}Kbc\end{tabular}} &\multicolumn{1}{c|}{B príjme správu} \\ \hline
\texttt{B4: B: compute h(Nb, Kbs)}                                                                                                                                                                                          & B vypoèíta správu                    \\ \hline
\texttt{B5: B: h(Nb, Kbs) xor (Kab xor h(Nb, Kbs))}                                                                                                                                                                         & B získa kµúè Kab                     \\ \hline
\texttt{B6: B: decrypt \{B, A, Nb\}Kab}                                                                                                                                                                                     & B de¹ifruje správu                   \\ \hline
\texttt{B7: B: h(Nb, Kbs) xor (Kbc xor h(Nb, Kbs))}                                                                                                                                                                         & B získa kµúè Kbc                     \\ \hline
\texttt{B8: B: decrypt \{B, C, Nb\}Kbc}                                                                                                                                                                                     & B de¹ifruje správu                   \\ \hline
\texttt{B9: B->: A, B, Kab xor h(Na, Kas), \{A, B, Na\}Kab}                                                                                                                                                                  & B po¹le správu                       \\ \hline
\end{tabular}}
\end{table}

\noindent \textbf{BP z pohµadu subjektu C:}
\begin{table}[h]
\scalebox{0.8}{
\begin{tabular}{|l|l|}
\hline
\textbf{Správa}                                                                                                                                                                                                                  & \textbf{Popis}                       \\ \hline
\texttt{C1: C: computes Xc = h((C, S, Nc, Xb), Kcs), (C, S, Nc, Xb)}                                                                                                                                                                     & C vytvorí správu                     \\ \hline
\texttt{C2: C->: Xc}                                                                                                                                                                                                                       & C po¹ele správu                      \\ \hline
\texttt{\begin{tabular}[c]{@{}l@{}}C3: ->C: A, B, Kab xor h(Na, Kas), \{A, B, Na\}Kab,\\ \hspace{10 mm} B, A, Kab xor h(Nb, Kbs), \{B, A, Nb\}Kab,\\ \hspace{10 mm} B, C, Kbc xor h(Nb, Kbs), \{B, C, Nb\}Kbc,\\ \hspace{10 mm} C, B, Kbc xor h(Nc, Kcs), \{C, B, Nc\}Kbc\end{tabular}} & \multicolumn{1}{c|}{C príjme správu} \\ \hline
\texttt{C4: C: compute h(NC, Kcs)}                                                                                                                                                                                                        & C vypoèíta správu                    \\ \hline
\texttt{C5: C: h(Nc, Kcs) xor (Kbc xor h(Nc, Kcs))}                                                                                                                                                                                       & C získa kµúè Kab                     \\ \hline
\texttt{C6: C: decrypt \{B,C, Nc\}Kbc}                                                                                                                                                                                                    & C de¹ifruje správu                   \\ \hline
\texttt{\begin{tabular}[c]{@{}l@{}}C7: C->: A, B, Kab xor h(Na, Kas), \{A, B, Na\}Kab,\\  \hspace{10 mm} B, A, Kab xor h(Nb, Kbs), \{B, A, Nb\}Kab,\\  \hspace{10 mm} B, C, Kbc xor h(Nb, Kbs), \{B, C, Nb\}Kbc\end{tabular}}                                            & C po¹le správy                       \\ \hline
\end{tabular}}
\end{table}

\noindent \textbf{BP z pohµadu subjektu S:}

\begin{table}[h]
\scalebox{0.8}{
\begin{tabular}{|l|l|}
\hline
\textbf{Správa}                                                                                                                                                                                                                          & \textbf{Popis}                        \\ \hline
\texttt{S3: ->S: Xc}                                                                                                                                                                                                                               & S príjme správu                       \\ \hline
\texttt{\begin{tabular}[c]{@{}l@{}}S1: S: compute: A, B, Kab xor h(Na, Kas), \{A, B, Na\}Kab,\\ \hspace{10 mm} B, A, Kab xor h(Nb, Kbs), \{B, A, Nb\}Kab,\\ \hspace{10 mm} B, C, Kbc xor h(Nb, Kbs), \{B, C, Nb\}Kbc,\\\hspace{10 mm} C, B, Kbc xor h(Nc, Kcs), \{C, B, Nc\}Kbc\end{tabular}} & \multicolumn{1}{c|}{S vytvorí správu} \\ \hline                                                                                                                                                                                                        & S de¹ifruje správu                    \\ \hline
\texttt{\begin{tabular}[c]{@{}l@{}}S2: S->: A, B, Kab xor h(Na, Kas), \{A, B, Na\}Kab,\\ \hspace{10 mm} B, A, Kab xor h(Nb, Kbs), \{B, A, Nb\}Kab,\\ \hspace{10 mm} B, C, Kbc xor h(Nb, Kbs), \{B, C, Nb\}Kbc,\\\hspace{10 mm} C, B, Kbc xor h(Nc, Kcs), \{C, B, Nc\}Kbc\end{tabular}}         & S po¹le správy                        \\ \hline
\end{tabular}}
\end{table}

\chapter{Analýza chovania protkolu pomocou automatického nástroja}
Pri pou¾ití nástroja \textbf{SPAN} boli pou¾ité 3 z 4 metód. Metódy OFMC, ATSE, TA4SP vyhodnotili zdrojový kód protokolu ako bezpeèný. Bohu¾iaµ grafická reprezentácia týchto metód nebola správne ukonèená, tak¾e
je mo¾né ¾e pri písaní kódu protokolu pri¹lo k chybe. Metódu SATMC sa mi nepodarilo spusti», nakoµko nástroj SPAN nevygeneroval ¾iadne výsledky.
